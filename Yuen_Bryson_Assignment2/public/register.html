<!-- Register page, modified and borrowed Lab 14 and template from ww3schools.com -->
<!-- Author: Bryson Yuen -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Page</title>
<script>
    //display alert as a response when for loops from server.js are executed depending on the quantity inserted
    window.onload = function () {
        let params = (new URL(document.location)).searchParams;
        //if errorMessage is in qry string then put up alert with error message
        if (params.has("loginMessage")) {
            alert(params.get("loginMessage"));
        }
    }
</script>

<style>
/* Register Page Background */
html { 
        background-image: url(./images/background.jpg); 
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
    }
</style>
</head>
<body>
    <h1>Register a Poke Mart Account</h1>
    <p>To shop and purchase products please register to become a member!</p>
<!--Creates form for new users to make an account--> 
<!--Borrowed and modified code from Lab 14-->
<div id='account'>
    <form method="POST" action="process_register" name="Register">
    <div class="container">
        <input type="text" id="fullname" name="fullname" size="40" pattern="[a-zA-Z]+[ ]+[a-zA-Z]+" placeholder="Enter Full Name" required title="Use only letters for your full name."><br />

        <input type="text" id="username" name="username" size="40" pattern=".[a-z0-9]{3,10}$" placeholder="Enter Username" required title="Min: 4 Characters, Max: 10 Characters, Numbers & Letters Only."><br />
            <!--Range minimum had to be 3 in order for the minimum to be 4-->

        <input type="email" id="email" name="email" size="40" pattern="[a-z0-9._]+@[a-z0-9]+\.[a-z]{2,}$" placeholder="Enter Email" required title="Please enter a valid email using the format, xxx@yyy.zzz"><br />

        <input type="password" id="password" name="password" size="40" pattern=".{6,}" placeholder="Enter Password" required title="6 Characters Minimum."><br />

        <input type="password" id="repeat_password" name="repeat_password" size="40" pattern=".{6,}" placeholder="Repeat Password" required title="Password must be the same as above."><br />

        <input type="submit" value="Register" class="btn">
    </div>
    </form>
    <script>
        Register.action += document.location.search; // Saves the query string from the products _display.html for my invoice.html
    </script>
</div>
<!--Button for Users who have an existing account-->
<input type="button" name="olduser" value="For Users With Existing Accounts" class="btn2" onclick="window.location='./login.html' + document.location.search;">
</body>
</html>
<script>
    let params = (new URL(document.location)).searchParams;
    if (params.has('errors_obj')) {
        //convert string to json string to object
        var errors = JSON.parse(params.get('errors_obj'));
        for(err in errors) { 
            // put the error messages in the span for the element where the error occured
            document.getElementById(`${err}_errors`).innerHTML = errors[err].join('<br>');
            // put value back in textbox (make sticky)
            document.getElementById(err).value = params.get(err);
        }   
    }
</script>
